---
title: "MCMC tutorial"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{MCMC tutorial}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```


```{r setup}
require(mc2)
require(ggplot2)
```

We begin by defining a target log posterior density and a grid for plotting.
```{r grid, fig.width = 6, fig.height = 6}
log_prob <- function(x){donut(x)}
log_prob(c(2,3))
```

First we sample using the Metropolis algoritm.
```{r metropolis, fig.width = 6, fig.height = 6}
# Sample
iter  <- 3000
x0    <- stats::rnorm(2)
sig   <- 0.1
chain <- metropolis(log_prob, x0, iter, sig)
X     <- chain$x
x     <- X[,1]
y     <- X[,2]
```

```{r plot, fig.width = 7.2, fig.height = 6}
# Plot
p <- plot_distribution(donut)
df_path <- data.frame(x,y)
p <- p + geom_path(data=df_path, mapping=aes(x=x,y=y), inherit.aes = FALSE, color = "firebrick3", alpha = 0.7)
p
```
